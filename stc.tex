\documentclass[a4paper]{article}

\usepackage{preamble}
\usepackage{stc-macros}

\title{Synthetic Tait computability}
\author{Frank Tsai}

\begin{document}

\maketitle

\section{Internal type theory}

Internal to each logos $\cE$ is a dependent type theory.

\begin{itemize}
\item A closed type $\vdash A$ is an object $A$ in $\Sl{\cE}{\termObj{\cE}} = \cE$.
\item Given a closed type $\vdash A$, a type family $x : A \vdash B$ is an object $B$ in $\Sl{\cE}{A}$.
\item A term $\vdash a : A$ is a global element of $A$ in $\cE$.
\item A term $x : A \vdash b : B$ is a global element of $B$ in $\Sl{\cE}{A}$.
\end{itemize}
When $\Gamma = x_1 : A_1,\ldots,x_n : A_n$, we write $\Sl{\cE}{\Gamma}$ for the iterated slice $\Sl{\prn{\Sl{\prn{\Sl{\cE}{A_1}}}{\ldots}}}{A_n}$.
Note that logoi are closed under slicing; hence $\Sl{\cE}{\Gamma}$ is a logoi whose internal type theory may be regarded as a type theory \emph{relative to} $\Gamma$.

Let $A \in \Sl{\cE}{\Gamma}$ be a type.
We can identify $A$ with the unique morphism $A \to \termObj{\Sl{\cE}{\Gamma}}$; hence there is the pullback functor $\pb{A} : \Sl{\cE}{\Gamma} \to \Sl{\cE}{\Gamma,A}$ sending each type $B \in \Sl{\cE}{\Gamma}$ to the same type in the weakened context $\Gamma, x : A$.

For each type $A \in \Sl{\cE}{\Gamma}$, there is a term $x : \termObj{\Sl{\cE}{\Gamma,A}} \to \pb{A}(A)$ called the \emph{variable}.
We construct this term inside $\Sl{\cE}{\Gamma}$ as follows:
% https://q.uiver.app/#q=WzAsNSxbMiwxLCJBIl0sWzIsMiwiXFx0ZXJtT2Jqe1xcU2x7XFxjRX17XFxHYW1tYX19Il0sWzEsMiwiQSJdLFsxLDEsIlxcZG9tKFxccGJ7QX0oQSkpIl0sWzAsMCwiQSJdLFsyLDFdLFswLDFdLFszLDIsIlxccGJ7QX0oQSkiXSxbMywwXSxbMywxLCIiLDEseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XSxbNCwyLCJcXHRlcm1PYmp7XFxTbHtcXGNFfXtcXEdhbW1hLEF9fSIsMix7ImN1cnZlIjoyfV0sWzQsMCwiXFx0ZXJtT2Jqe1xcU2x7XFxjRX17XFxHYW1tYSxBfX0iLDAseyJjdXJ2ZSI6LTJ9XSxbNCwzLCJ4IiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV1d
\[\begin{tikzcd}
    A \\
    & {\dom(\pb{A}(A))} & A \\
    & A & {\termObj{\Sl{\cE}{\Gamma}}}
    \arrow["x"{description}, dashed, from=1-1, to=2-2]
    \arrow["{\termObj{\Sl{\cE}{\Gamma,A}}}", curve={height=-12pt}, from=1-1, to=2-3]
    \arrow["{\termObj{\Sl{\cE}{\Gamma,A}}}"', curve={height=12pt}, from=1-1, to=3-2]
    \arrow[from=2-2, to=2-3]
    \arrow["{\pb{A}(A)}", from=2-2, to=3-2]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=2-2, to=3-3]
    \arrow[from=2-3, to=3-3]
    \arrow[from=3-2, to=3-3]
  \end{tikzcd}\]

\begin{figure}
  \centering
  \begin{mathpar}
    \ebrule[Var]{
      \infer0{\Gamma,x : A \vdash x : A}
    }
  \end{mathpar}
  \caption{Structural rules}
  \label{fig:0001}
\end{figure}

\subsection{Dependent product types}

Let $A \in \Sl{\cE}{\Gamma}$ and $B \in \Sl{\cE}{\Gamma,A}$ be types.
The pullback functor $\pb{A} : \Sl{\cE}{\Gamma} \to \Sl{\cE}{\Gamma,A}$ admits a right adjoint functor $\pb{A} \adj \Pi_{A}$.

\emph{Formation}: Given types $A \in \Sl{\cE}{\Gamma}$ and $B \in \Sl{\cE}{\Gamma,A}$, $\Pi_{A}B$ is a type in $\Sl{\cE}{\Gamma}$.

\emph{Introduction}: Note that $\pb{A}(\termObj{\Sl{\cE}{\Gamma}}) = \termObj{\Sl{\cE}{\Gamma,A}}$; hence every term $t : \termObj{\Sl{\cE}{\Gamma,A}} \to B$ corresponds bijectively to a term $\lambda x : A.t : \termObj{\Sl{\cE}{\Gamma}} \to \Pi_AB$ under the adjunction $\pb{A} \adj \Pi_A$.

\emph{Elimination}: Suppose that we have two terms $f : \termObj{\Sl{\cE}{\Gamma}} \to \Pi_AB$ and $a : \termObj{\Sl{\cE}{\Gamma}} \to A$.
The term $f$ corresponds to a unique term $f' : \termObj{\Sl{\cE}{\Gamma,A}} \to B$; hence we have the following diagram in $\Sl{\cE}{\Gamma}$ in which the triangle commutes:
% https://q.uiver.app/#q=WzAsNCxbMiwxLCJBIl0sWzIsMCwiXFxkb20oQikiXSxbMSwwLCJBIl0sWzAsMCwiXFx0ZXJtT2Jqe1xcU2x7XFxjRX17XFxHYW1tYX19Il0sWzEsMCwiQiJdLFsyLDAsIlxcdGVybU9iantcXFNse1xcY0V9e1xcR2FtbWEsQX19IiwyXSxbMiwxLCJmJyJdLFszLDIsImEiXV0=
\[\begin{tikzcd}
    {\termObj{\Sl{\cE}{\Gamma}}} & A & {\dom(B)} \\
    && A
    \arrow["a", from=1-1, to=1-2]
    \arrow["{f'}", from=1-2, to=1-3]
    \arrow["{\termObj{\Sl{\cE}{\Gamma,A}}}"', from=1-2, to=2-3]
    \arrow["B", from=1-3, to=2-3]
  \end{tikzcd}\]
Then the term $f' \circ a : \termObj{\Sl{\cE}{\Gamma}} \to \dom(B)$ corresponds uniquely to a term $f(a) : \termObj{\Sl{\cE}{\Gamma}} \to B[a/x]$ via the following pullback diagram:
% https://q.uiver.app/#q=WzAsNSxbMSwxLCJCW2EveF0iXSxbMSwyLCJcXHRlcm1PYmp7XFxTbHtcXGNFfXtcXEdhbW1hfX0iXSxbMiwyLCJBIl0sWzIsMSwiXFxkb20oQikiXSxbMCwwLCJcXHRlcm1PYmp7XFxTbHtcXGNFfXtcXEdhbW1hfX0iXSxbMSwyLCJhIiwyXSxbMywyLCJCIl0sWzAsMV0sWzAsM10sWzAsMiwiIiwxLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV0sWzQsMSwiXFx0ZXJtT2Jqe1xcU2x7XFxjRX17XFxHYW1tYSxBfX0iLDIseyJjdXJ2ZSI6Mn1dLFs0LDMsImYnIFxcY2lyYyBhIiwwLHsiY3VydmUiOi0yfV0sWzQsMCwiZihhKSIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
    {\termObj{\Sl{\cE}{\Gamma}}} \\
    & {B[a/x]} & {\dom(B)} \\
    & {\termObj{\Sl{\cE}{\Gamma}}} & A
    \arrow["{f(a)}"{description}, dashed, from=1-1, to=2-2]
    \arrow["{f' \circ a}", curve={height=-12pt}, from=1-1, to=2-3]
    \arrow["{\termObj{\Sl{\cE}{\Gamma,A}}}"', curve={height=12pt}, from=1-1, to=3-2]
    \arrow[from=2-2, to=2-3]
    \arrow[from=2-2, to=3-2]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=2-2, to=3-3]
    \arrow["B", from=2-3, to=3-3]
    \arrow["a"', from=3-2, to=3-3]
  \end{tikzcd}\]

\emph{$\beta$-law}: Given two terms $t : \termObj{\Sl{\cE}{\Gamma,A}} \to B$ and $a : \termObj{\Sl{\cE}{\Gamma}} \to A$, the term $t[a/x]$ is given by the following pullback diagram:
% https://q.uiver.app/#q=WzAsNSxbMSwxLCJCW2EveF0iXSxbMSwyLCJcXHRlcm1PYmp7XFxTbHtcXGNFfXtcXEdhbW1hfX0iXSxbMiwyLCJBIl0sWzIsMSwiXFxkb20oQikiXSxbMCwwLCJcXHRlcm1PYmp7XFxTbHtcXGNFfXtcXEdhbW1hfX0iXSxbMSwyLCJhIiwyXSxbMywyLCJCIl0sWzAsMV0sWzAsM10sWzAsMiwiIiwxLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV0sWzQsMSwiXFx0ZXJtT2Jqe1xcU2x7XFxjRX17XFxHYW1tYSxBfX0iLDIseyJjdXJ2ZSI6Mn1dLFs0LDMsInQgXFxjaXJjIGEiLDAseyJjdXJ2ZSI6LTJ9XSxbNCwwLCJ0W2EveF0iLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XV0=
\[\begin{tikzcd}
    {\termObj{\Sl{\cE}{\Gamma}}} \\
    & {B[a/x]} & {\dom(B)} \\
    & {\termObj{\Sl{\cE}{\Gamma}}} & A
    \arrow["{t[a/x]}"{description}, dashed, from=1-1, to=2-2]
    \arrow["{t \circ a}", curve={height=-12pt}, from=1-1, to=2-3]
    \arrow["{\termObj{\Sl{\cE}{\Gamma,A}}}"', curve={height=12pt}, from=1-1, to=3-2]
    \arrow[from=2-2, to=2-3]
    \arrow[from=2-2, to=3-2]
    \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=2-2, to=3-3]
    \arrow["B", from=2-3, to=3-3]
    \arrow["a"', from=3-2, to=3-3]
  \end{tikzcd}\]
Since $\lambda x : A.t$ corresponds precisely to $t$, we conclude that the application $(\lambda x : A.t)(a)$ equals $t[a/x]$ by uniqueness.

\todo\emph{$\eta$-law}:

We have demonstrated how to translate $\Pi$-types in the internal type theory into its external language (objects and morphisms in $\cE$).

\begin{figure}
  \centering
  \begin{mathpar}
    \ebrule[$\Pi$-F]{
      \hypo{\Gamma, x : A \vdash B}
      \infer1{\Gamma \vdash \Pi_{x : A}B}
    }\and
    \ebrule[$\Pi$-I]{
      \hypo{\Gamma, x : A \vdash t : B}
      \infer1{\Gamma \vdash \lambda x : A.t : \Pi_{x : A}B}
    }\and
    \ebrule[$\Pi$-E]{
      \hypo{\Gamma \vdash f : \Pi_{x : A}B}
      \hypo{\Gamma \vdash a : A}
      \infer2{\Gamma \vdash f(a) : B[a/x]}
    }\and
    \ebrule[$\Pi$-$\beta$]{
      \hypo{\Gamma, x : A \vdash t : B}
      \hypo{\Gamma \vdash a : A}
      \infer2{\Gamma \vdash (\lambda x : A.t)(a) = t[a/x] : B[a/x]}
    }\and
    \ebrule[$\Pi$-$\eta$]{
      \hypo{\Gamma \vdash f : \Pi_{x : A}B}
      \infer1{\Gamma \vdash f = \lambda x : A.f(x) : \Pi_{x : A}B}
    }
  \end{mathpar}
  \caption{Rules for $\Pi$-types}
  \label{fig:0000}
\end{figure}

\subsection{Dependent sum types}

Let $A \in \Sl{\cE}{\Gamma}$ and $B \in \Sl{\cE}{\Gamma,A}$ be types.
The pullback functor $\pb{A} : \Sl{\cE}{\Gamma} \to \Sl{\cE}{\Gamma,A}$ admits a left adjoint functor $\Sigma_{A} \adj \pb{A}$; the left adjoint functor has an explicit formula: $\Sigma_A = A \circ (-)$.

\emph{Formation}: Given two types $A \in \Sl{\cE}{\Gamma}$ and $B \in \Sl{\cE}{\Gamma,A}$, we have a type $\Sigma_AB \in \Sl{\cE}{\Gamma}$.
Explicitly, $\Sigma_AB$ is equivalently the following composite in $\Sl{\cE}{\Gamma}$:
% https://q.uiver.app/#q=WzAsMyxbMSwxLCJcXHRlcm1PYmp7XFxTbHtcXGNFfXtcXEdhbW1hfX0iXSxbMCwwLCJBIl0sWzEsMCwiXFxTaWdtYV9BQiJdLFsxLDBdLFsyLDEsIkIiLDJdLFsyLDAsIiIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRvdHRlZCJ9fX1dXQ==
\[\begin{tikzcd}
    A & {\Sigma_AB} \\
    & {\termObj{\Sl{\cE}{\Gamma}}}
    \arrow[from=1-1, to=2-2]
    \arrow["B"', from=1-2, to=1-1]
    \arrow[dotted, from=1-2, to=2-2]
  \end{tikzcd}\]
Henceforth, we write $\Sigma_AB$ for the domain (or \emph{total space}) of the type family $B : \Sigma_AB \to A$ in $\Sl{\cE}{\Gamma}$.

\emph{Introduction}: Suppose that we have two terms $a : \termObj{\Sl{\cE}{\Gamma}} \to A$ and $b : \termObj{\Sl{\cE}{\Gamma}} \to B[a/x]$.
Observe that $\Sigma_a(\termObj{\Sl{\cE}{\Gamma}}) = \termObj{\Sl{\cE}{\Gamma,A}}$; hence the term $b$ corresponds bijectively to a term $b' : \termObj{\Sl{\cE}{\Gamma,A}} \to B$ under the adjunction $\Sigma_a \adj \pb{a}$.
Again, observe that $\Sigma_A(\termObj{\Sl{\cE}{\Gamma,A}}) = \termObj{\Sl{\cE}{\Gamma}}$; hence $\Sigma_A(b') : \termObj{\Sl{\cE}{\Gamma}} \to \Sigma_AB$ is the required term.

\emph{Elimination}: Suppose that we have a term $c : \termObj{\Sl{\cE}{\Gamma}} \to \Sigma_AB$.
The term $\prl(c) : \termObj{\Sl{\cE}{\Gamma}} \to A$ is given by the following composite in $\Sl{\cE}{\Gamma}$:
% https://q.uiver.app/#q=WzAsMyxbMSwwLCJcXHRlcm1PYmp7XFxTbHtcXGNFfXtcXEdhbW1hfX0iXSxbMSwxLCJBIl0sWzAsMCwiXFxTaWdtYV9BQiJdLFsyLDEsIkIiLDJdLFswLDIsImMiLDJdLFswLDEsIlxccHJsKGMpIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn19fV1d
\[\begin{tikzcd}
    {\Sigma_AB} & {\termObj{\Sl{\cE}{\Gamma}}} \\
    & A
    \arrow["B"', from=1-1, to=2-2]
    \arrow["c"', from=1-2, to=1-1]
    \arrow["{\prl(c)}", dotted, from=1-2, to=2-2]
  \end{tikzcd}\]
Note that $c$ is a morphism $B \circ c \to B$ in $\Sl{\cE}{\Gamma,A}$; moreover, $\Sigma_{\prl(c)}(\termObj{\Sl{\cE}{\Gamma}}) = \prl(c) = B \circ c$.
Then, we take $\prr(c) : \termObj{\Sl{\cE}{\Gamma}} \to \pb{(\prl(c))}(B)$ to be the unique term that corresponds to $c : \Sigma_{\prl(c)}(\termObj{\Sl{\cE}{\Gamma}}) \to B$ under the adjunction $\Sigma_{\prl(c)} \adj \pb{(\prl(c))}$.

\todo \emph{$\beta$-law}:

\todo \emph{$\eta$-law}:

\begin{figure}
  \centering
  \begin{mathpar}
    \ebrule[$\Sigma$-F]{
      \hypo{\Gamma, x : A \vdash B}
      \infer1{\Gamma \vdash \Sigma x : A.B}
    }\and
    \ebrule[$\Sigma$-I]{
      \hypo{\Gamma \vdash a : A}
      \hypo{\Gamma \vdash b : B[a/x]}
      \infer2{\Gamma \vdash \pair{a}{b} : \Sigma x : A.B}
    }\and
    \ebrule[$\Sigma$-E$_1$]{
      \hypo{\Gamma \vdash c : \Sigma x : A.B}
      \infer1{\Gamma \vdash \prl(c) : A}
    }\and
    \ebrule[$\Sigma$-E$_2$]{
      \hypo{\Gamma \vdash c : \Sigma x : A.B}
      \infer1{\Gamma \vdash \prr(c) : B[\prl(c)/x]}
    }\and
    \ebrule[$\Sigma$-$\beta_1$]{
      \hypo{\Gamma \vdash a : A}
      \hypo{\Gamma \vdash b : B[a/x]}
      \infer2{\Gamma \vdash \prl(\pair{a}{b}) = a : A}
    }\and
    \ebrule[$\Sigma$-$\beta_2$]{
      \hypo{\Gamma \vdash a : A}
      \hypo{\Gamma \vdash b : B[a/x]}
      \infer2{\Gamma \vdash \prr(\pair{a}{b}) = b : B[a/x]}
    }\and
    \ebrule[$\Sigma$-$\eta$]{
      \hypo{\Gamma \vdash c : \Sigma x : A.B}
      \infer1{\Gamma \vdash c = \pair{\prl(c)}{\prr(c)} : \Sigma x : A.B}
    }
  \end{mathpar}
  \caption{Rules for $\Sigma$-types}
  \label{fig:0002}
\end{figure}

\subsection{Internal logic}

Each $\Sl{\cE}{\Gamma}$ is equipped with a subobject classifier $\subClf{\Sl{\cE}{\Gamma}}$ and a generic monomorphism $\genMono{\Sl{\cE}{\Gamma}} : \termObj{\EGamma} \mono \subClf{\EGamma}$; hence a term $\phi : \termObj{\EGamma} \to \subClf{\EGamma}$ corresponds to a unique subterminal object $\name{\phi} \mono \termObj{\EGamma}$ and \viceversa.
We leave the decoding $\name{-}$ implicit.

We refer to terms $\phi : \subClf{\EGamma}$, or the explicit decoding $\name{\phi}$, as \emph{propositions} rather than types; and we refer to a proposition $\psi : \subClf{\EGammaA}$ as a \emph{predicate over $A$}.

The dependent product $\Pi_A$, as a right adjoint functor, preserves monomorphisms; hence if $\phi : \subClf{\EGammaA}$ is a predicate over $A$, the type $\Pi_A\phi$ is a proposition called the \emph{universal quantification of $\phi$ over $A$}.
We write $\forall_A\phi$ for $\Pi_A\phi$.

Any two inhabitants of $\phi$ are equal since $\phi$ is a subterminal object; hence if $\star : \phi$, we refer to $\star$ as a \emph{proof} of $\phi$.

\subsection{Identity proposition}

\begin{definition}
  Given a type $A \in \EGamma$, there is a diagonal map $\Delta : A \mono A \times A$.
  For any two terms $\Gamma \vdash a, a' : A$, we define the \emph{identity proposition} as the following pullback:
  % https://q.uiver.app/#q=WzAsNixbMSwwLCJBIl0sWzEsMiwiQSBcXHRpbWVzIEEiXSxbMiwyLCJcXHN1YkNsZntcXEVHYW1tYX0iXSxbMiwwLCJcXHRlcm1PYmp7XFxFR2FtbWF9Il0sWzAsMiwiXFx0ZXJtT2Jqe1xcRUdhbW1hfSJdLFswLDAsIlxcdHlwZUlke0F9e2F9e2EnfSJdLFswLDEsIlxcRGVsdGEiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJtb25vIn19fV0sWzEsMiwiXFxkZWx0YSIsMl0sWzMsMiwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibW9ubyJ9fX1dLFswLDNdLFswLDIsIiIsMSx7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dLFs0LDEsIihhLGEnKSIsMl0sWzUsNCwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoibW9ubyJ9fX1dLFs1LDBdLFs1LDEsIiIsMix7InN0eWxlIjp7Im5hbWUiOiJjb3JuZXIifX1dXQ==
  \[\begin{tikzcd}
      {\idType{A}{a}{a'}} & A & {\termObj{\EGamma}} \\
      \\
      {\termObj{\EGamma}} & {A \times A} & {\subClf{\EGamma}}
      \arrow[from=1-1, to=1-2]
      \arrow[tail, from=1-1, to=3-1]
      \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-1, to=3-2]
      \arrow[from=1-2, to=1-3]
      \arrow["\Delta"', tail, from=1-2, to=3-2]
      \arrow["\lrcorner"{anchor=center, pos=0.125}, draw=none, from=1-2, to=3-3]
      \arrow[tail, from=1-3, to=3-3]
      \arrow["{(a,a')}"', from=3-1, to=3-2]
      \arrow["\delta"', from=3-2, to=3-3]
    \end{tikzcd}\]
\end{definition}

Observe that $\idType{A}{a}{a'}$ is inhabited if and only if $a = a'$ as global elements of $A$.

\begin{figure}
  \centering
  \begin{mathpar}
    \ebrule[$=$-F]{
      \hypo{\Gamma \vdash a : A}
      \hypo{\Gamma \vdash a' : A}
      \infer2{\Gamma \vdash \idType{A}{a}{a'}}
    }\and
    \ebrule[$=$-I]{
      \hypo{\Gamma \vdash a : A}
      \infer1{\Gamma \vdash \star : \idType{A}{a}{a}}
    }\and
    \ebrule[$=$-E]{
      \hypo{\Gamma \vdash \star : \idType{A}{a}{a'}}
      \infer1{\Gamma \vdash a = a' : A}
    }
  \end{mathpar}
  \caption{Rules for identity propositions}
  \label{fig:0004}
\end{figure}

\subsection{Comprehension types}

\begin{definition}
  Given a type $A \in \EGamma$ and a predicate $\phi : \subClf{\EGammaA}$, the \emph{comprehension type} $\compType{a : A}{\phi}$ is defined to be the type $\Sigma_A\phi \in \EGamma$; hence we may manipulate comprehension types using the rules in \cref{fig:0002}, although it may be more convenient to use the rules in \cref{fig:0003}.

  Note that $\Sigma_A\phi$ is not necessarily a proposition, so it does not make sense to call it the existential quantification of $\phi$ over $A$.
\end{definition}

\begin{figure}
  \centering
  \begin{mathpar}
    \ebrule[C-F]{
      \hypo{\Gamma \vdash A}
      \hypo{\Gamma, x : A \vdash \name{\phi}}
      \infer2{\Gamma \vdash \compType{a : A}{\name{\phi}}}
    }\and
    \ebrule[C-I]{
      \hypo{\Gamma \vdash a : A}
      \hypo{\Gamma \vdash \star : \name{\phi}[a/x]}
      \infer2{\Gamma \vdash \roll(a) : \compType{a : A}{\name{\phi}}}
    }\and
    \ebrule[C-E]{
      \hypo{\Gamma \vdash c : \compType{a : A}{\name{\phi}}}
      \infer1{\Gamma \vdash \unroll(c) : A}
    }\and
    \ebrule[C-$\beta$]{
      \hypo{\Gamma \vdash a : A}
      \hypo{\Gamma \vdash \star : \name{\phi}[a/x]}
      \infer2{\Gamma \vdash \unroll(\roll(a)) = a : A}
    }
  \end{mathpar}
  \caption{Rules for comprehension types}
  \label{fig:0003}
\end{figure}

\subsection{Universes}

\todo ...

\subsection{Extent types}

\begin{definition}\label{def:0000}
  Given a proposition $\phi : \subClf{\EGamma}$ and a partial type $\Gamma, z : \phi \vdash A : \U{\Sl{\cE}{\Gamma,\phi}}$.
  The \emph{direct image} of $A$ in $\U{\EGamma}$ is defined to be the type $\Gamma \vdash \Pi_{\phi}A : \U{\EGamma}$.
\end{definition}

\begin{definition}
  When $\Gamma \vdash A : \U{\EGamma}$ is a total type, we can weaken it along $\phi$ to obtain a partial type (which we also denote by $A$) $\Gamma, z : \phi \vdash A : \U{\Sl{\cE}{\Gamma,\phi}}$.
  The \emph{partial element type} $\Pi_{\phi}A$ is a special case of \cref{def:0000}.
\end{definition}

\begin{definition}
  Let $A : \U{\EGamma}$ be a type and $a : \Pi_{\phi}A$ be a partial element defined on $\phi : \subClf{\EGamma}$.
  The extent type $\extentType{a' : A}{\phi}{a}$ is defined to be the comprehension type $\compType{a' : A}{\forall z : \phi.a' = a(z)}$.
\end{definition}

\bibliography{bib}
\bibliographystyle{alpha}

\end{document}
